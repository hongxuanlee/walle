/**
 * @author  ddchen
 */

var DEFAULT_BLOCKNAME = '__g__0';

var queryBlockName = function(selector, __blockMap) {
	if (!selector) return DEFAULT_BLOCKNAME;
	var key = selector.key;
	var value = selector.value;
	var funcs = [];
	if (key !== undefined && value !== undefined) {
		for (var name in __blockMap) {
			var block = __blockMap[name];
			if (block.opts[key] == value) {
				return name;
			}
		}
	} else {
		return defaultFunc;
	}
}

module.exports = function(proto) {

	proto.queryBlock = function(selector) {
		var blockName = queryBlockName(selector, this.__blockMap);
		if (!blockName) {
			console && console.warn("can not find block for selector " + JSON.stringify(selector));
			return null;
		}
		return this.__blockMap[blockName];
	}
}